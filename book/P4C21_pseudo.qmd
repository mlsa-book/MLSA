---
abstract: This chapter introduces pseudo-value regression as a flexible reduction technique for survival analysis that enables the use of standard regression and machine learning methods with censored time-to-event data. The core idea is to transform censored and uncensored survival outcomes into pseudo-values derived from univariate estimators of a quantity of interest, such as survival probabilities or the restricted mean survival time (RMST). These pseudo-values serve as regression targets, allowing conditional predictions to be learned directly as functions of covariates without requiring strong structural assumptions on the underlying hazard or survival process. The chapter presents the jackknife-based construction of pseudo-values, discusses their statistical properties, and explains how response (link) functions can be used to respect natural constraints of the target quantity. Through worked examples, the approach is illustrated for survival probabilities and RMST, highlighting interpretability, time-varying covariate effects, and practical implementation. Extensions to competing risks and multi-state models are also outlined. Overall, pseudo-value regression provides a conceptually simple yet powerful bridge between classical survival analysis and modern regression-based prediction methods, though are limited when the dataset is very large or more than a handful of time points are of interest.
---

::: {.content-visible when-format="html"}
{{< include _macros.tex >}}
:::

# Pseudo-value Regression {#sec-pseudo-value-reduction}

{{< include _wip_minor.qmd >}}

Pseudo-value based approaches are relatively new [see @Andersen2010 for an overview] but have quickly gained traction due to their flexibility and ease of application. 
This approach allows regression learners to be used to make predictions for transformed survival data, conditional on covariates, after both censored and uncensored survival times are transformed to _pseudo-values_.
This reduction has two transformation steps.
Firstly, the survival outcomes $(\tt, \bsdelta)$ are transformed to 'pseudo-values' $\tilde{\bstheta}$, termed because they do not represent the genuine outcome of interest but a close representation instead
Then, a simple regression model is trained to learn the relationship between the features from the original dataset to the pseudo-values.

Formally, let $\psi(\tau|\xx)$ denote some quantity of interest, for example the survival probability $S(\tau | \xx)$ or the restricted mean survival time, $\text{RMST}(\tau | \xx)$. 
Let $\psi(\tau)$ be a univariate (featureless), unbiased estimator of the quantity of interest, such as the Kaplan-Meier estimator, estimated as normal from all observations.
Let $\psi^{-i}(\tau)$ be the same estimator but fit by omitting the $i$-th observation from the data set.
Let $n$ the size of the data set. 
The pseudo-value for observation $i$ is defined by the jackknife procedure,
<!--  -->
$$
\theta_i(\tau) = n\psi(\tau) - (n-1)\psi^{-i}(\tau).
$${#eq-pseudo-value}
<!--  -->

Thus, the calculation of all pseudo-values, $\dvec{\theta}{n}$, requires $n+1$ estimates of the univariate estimator $\psi(\tau)$ ($n$ calculations of $\psi^{-i}(\tau)$ and one calculation of $\psi(\tau)$) per $m$ time points of interest leading to $m(n+1)$ total calculations.
This may seem prohibitive, but calculation of univariate estimators are usually very fast, also methods that use efficient approximations have been proposed in the literature [@parnerRegressionModelsCensored2023; @bouaziz2023fastapproximations].
Furthermore, pseudo-value analysis is most commonly used when only a few time points are of interest so $m$ is small.

Pseudo-values are constructed such that their empirical mean is an unbiased estimator of the target quantity of interest,

$$
E(\theta_i(\tau)) = \psi(\tau).
$$ {#eq-pseudo-value-expectation-1}

For example, if $\psi$ is the Kaplan-Meier estimator, this implies that pseudo-values at time $\tau$ are, on average, unbiased for the Kaplan-Meier estimator evaluated at the same time point; motivating the use of pseudo-values as targets for regression models.

The relationship between features $\xx_i$ and pseudo-values $\theta_i(\tau)$ is learned through a regression model, fitted separately for each $\tau$ of interest,
<!--  -->
$$
E(\theta_i(\tau|\xx_i)) = h(f_{\tau}(\xx_i)),
$$ {#eq-pseudo-value-expectation-2}
<!--  -->
where $f_{\tau}(\xx_i)$ is a function of the features $\xx_i$ that is learned by the model; for example, $f_{\tau} = \xx^\top\bsbeta_{\tau}$ for linear regression.
The subscript $\tau$ indicates that the function is different for each time point $\tau$.
The function $h(\cdot)$ is a given response (or 'link') function that maps the predictor to the target space; for example, the identity or sigmoid functions.
The response function is required as pseudo-values can take any value on $\Reals$ but the target quantity of interest might be constrained to a smaller set, for example survival probabilities must be within $[0,1]$.
The response function may be estimated during model fitting, as in generalized estimating equations [@hardinGeneralizedEstimatingEquations2012], or applied to the raw predictions as in many machine learning methods.

It follows from (@eq-pseudo-value-expectation-1) and (@eq-pseudo-value-expectation-2) that the fitted regression models can be used to make predictions of the quantity of interest conditional on covariates from new data $\xx^*$,

$$
\hat{\tilde{\theta}}(\tau|\xx^*) = \hat{\psi}(\tau|\xx^*) = h(\hat{f}_{\tau}(x)).
$$

The following sections will provide step-by-step examples of pseudo-value based prediction for two specific quantities of interest: survival probabilities (@sec-pseudo-value-S) and the restricted mean survival time (@sec-pseudo-value-rmst).
@sec-pseudo-value-eha extends this reduction to competing risks and multi-state models.

## Pseudo-values for survival probability {#sec-pseudo-value-S}

This section details the use of pseudo-values for the estimation of the survival probability conditional on features. 
For illustration, consider the tumor data set (introduced in @sec-data-rc, @tbl-surv-data-tumor), which contains right-censored data for $n=776$ observations on time-until-death after operation (in days) and features 'age' and 'complications', which indicates whether complications occurred during tumor removal.
For this example, a simple linear model is used for (@eq-pseudo-value-expectation-2) but recall any regression model (including machine learning methods) is possible.

Say one is interested in the conditional survival probability of tumor patients at time points $\tau \in \{1000, 2000, 3000\}$ days. 
Therefore, the true quantity of interest is $\psi(\tau|\xx_i) = S(\tau|\xx_i)$, for which a natural univariate estimator is the Kaplan-Meier method, $\hat{\psi}(\tau) = \hat{S}_{KM}(\tau)$.
Pseudo-values are then calculated as
<!--  -->
$$
\tilde{\theta}_i(\tau) = n\hat{S}_{KM}(\tau) - (n-1)\hat{S}_{KM}^{-i}(\tau).
$$ {#eq-pseudo-value-calculation-S}

The resulting estimates and calculated pseudo-values are shown for the first 4 subjects of the data in @tbl-pseudo-value-calculation for $\tau = 1000$ days. 
While the differences in leave-one-out Kaplan-Meier estimates appear small ($<0.01$ difference), these lead to larger differences in pseudo-values once multiplied by $n-1$ as in (@eq-pseudo-value-calculation-S)

| complications | age | $i$| $t_i$| $\delta_i$| $\hat{S}_{KM}(\tau)$| $\hat{S}_{KM}^{-i}(\tau)$| $\tilde{\theta}_i(\tau)$|
|:-------|-------:|-------:|-------:|-------:|-------:|-------:|-------:|
|  no | 58 |       1|  579|      0|     0.6175|     0.6172|       0.8597|
|  yes | 52  |       2| 1192|      0|     0.6175|     0.6169|       1.0600|
|  no | 74          |       3|  308|      1|     0.6175|     0.6184|      -0.0442|
|  yes | 57        |       4|   33|      1|     0.6175|     0.6183|      -0.0119|

: Illustration of pseudo-value calculation for the first 4 subjects from the tumor data set at time point $\tau = 1000$ days. The table shows the overall Kaplan-Meier estimate $\hat{S}_{KM}(\tau)$ calculated for all $776$ subjects, the leave-one-out Kaplan-Meier estimate $\hat{S}_{KM}^{-i}(\tau)$ (obtained by omitting subject $i$), and the calculated pseudo-value $\tilde{\theta}_i(\tau)$. The features age and complications are not used for the calculation of the pseudo-values but are included in the regression step. {#tbl-pseudo-value-calculation}

A linear model is then fitted to the pseudo-values obtained in @tbl-pseudo-value-calculation such that 
<!--  -->
$$
\hat{\tilde{\theta}}_i(\tau) = \hat{S}(\tau|\xx_i) = \xx_i^\top\hat{\bsbeta}_{\tau}.
$$ {#eq-pseudo-value-S-lm}
<!--  -->

To guarantee pseudo-values are within the required range, one can then apply the sigmoid function

$$
h(x) = \frac{1}{1 + e^{-x}},
$$

resulting in a prediction for new data $\xx^*$,

$$
\hat{\tilde{\theta}}(\tau|\xx^*) = \hat{S}(\tau|\xx_i^*) = \left(1 + e^{-( \xx_i^\top\hat{\bsbeta}_{\tau})}\right)^{-1}.
$$ 

To illustrate some of the main advantages of this method, now consider fitting the pseudo-values using a linear model of the form:

$$
\hat{\tilde{\theta}}(\tau) = \hat{S}(\tau|\xx_i) = \hat{\beta}_{\tau,0} + \hat{\beta}_{\tau,1} x_{i,1},\quad x_{i,1} = \mathbb{I}(\text{complications}_i = \text{`yes'}),
$$ {#eq-pseudo-value-S-lm-complications}

for time points $\tau \in \{1000, 2000, 3000\}$ days and let the response be the identity function, $h(x) = x$. 

The results are shown in @fig-pseudo-lm, where the black dots indicate the survival probability predictions from (@eq-pseudo-value-S-lm-complications) and the solid lines are Kaplan-Meier estimates of the survival probabilities. 
The Kaplan-Meier estimates visualized in the solid lines are stratified by the 'complication' variable, though the usual unstratified, univariate Kaplan-Meier is used for the pseudo-value calculations.
Despite not stratifying the estimator when calculating the pseudo-values, the pseudo-value estimates are still very close to the corresponding stratified Kaplan-Meier estimates.
Furthermore, the difference in curves may suggest the proportional hazards assumption does not hold for this data (intuitively, patients with complications have a higher hazard in the first days after operation and therefore lower survival probability) but the pseudo-value approach can handle this as the regression model is fit to $\hat{\beta}_{\tau,0}$ and $\hat{\beta}_{\tau,1}$ separately for each $\tau$.

Despite using the identity response function, the estimated values are still within the required $[0,1]$ range and can in fact be directly interpreted as the effect of complications on the survival probability at time $\tau$ (in contrast to say a Cox model which can only be directly interpreted in terms of hazard ratios). 
Here, $\hat{\beta}_{1000,1}\approx -0.23$ and so the expected survival probability at time $\tau = 1000$ for patients with complications is reduced by around 23 percentage points compared to patients without complications.
This interpretability also carries to other time-points, for example at $\tau = 2000$ days, $\hat{\beta}_{2000,1} \approx -0.18$, and at $\tau = 3000$ days, $\hat{\beta}_{3000,1} \approx -0.13$, thus the average effect of complications depends on $\tau$ and decreases over time (complications have a time-varying effect). 

![Comparison of estimates of the survival probability estimates using the Kaplan-Meier estimator and estimates of a linear model based on pseudo-values.](Figures/survival/pseudo-complications-lm.png){#fig-pseudo-lm fig-alt=""}

Of course, if the data only contained a single, discrete covariate, then a stratified Kaplan-Meier estimator could be used instead of the pseudo-value approach.
So as a final illustration, consider adding age to the model,
$$
\hat{S}(\tau|\xx_i) = \hat{\beta}_{\tau,0} + \hat{\beta}_{\tau,1} x_{i,1} + \hat{\beta}_{\tau,2} x_{i,2},\quad x_{i,1} = \mathbb{I}(\text{complications}_i = \text{`yes'}), x_{i,2} = \text{age}_i,
$$

assume again $h(x) = x$.
The resulting estimates are in @tbl-pseudo-lm-age, where the effects of age and complications are calculated for each time-point $\tau \in \{1000, 2000, 3000\}$ days separately.

| $\tau$|     $\hat{\beta}_{\tau,1}$| $\hat{\beta}_{\tau,2}$|
|--------:|-------------:|-------:|
|     1000|       -0.2205| -0.0032|
|     2000|       -0.1428| -0.0070|
|     3000|       -0.1050| -0.0071|
: Estimates of the effects of age and complications on the survival probability at different time points $\tau \in \{1000, 2000, 3000\}$ days. {#tbl-pseudo-lm-age}

Conditional on $\tau$, the interpretation is equivalent to a standard multiple linear regression model. For example, at $\tau = 1000$ days, the effect of age is $\hat{\beta}_{1000,2} \approx -0.0032$, which means that, given everything else being equal, the expected survival probability is reduced by around 0.32 percentage points per additional year of age.
In contrast, at $\tau=2000$ days, the survival probability is reduced by around 0.70 percentage points per additional year of age, meaning age has more than double the impact over time (though in absolute terms still very small).

## Pseudo-values for RMST {#sec-pseudo-value-rmst}

Another common use for the pseudo-value approach is the restricted mean survival time (RMST; @sec-survtsk), for which an unbiased, univariate estimator is 
<!--  -->
$$
\text{RMST}(\tau) = \int_0^\tau S_{KM}(y) \ \dy,
$$
<!--  -->
giving the calculated pseudo-values
<!--  -->
$$
\tilde{\theta}_i(\tau) = n \widehat{\text{RMST}}(\tau) - (n-1)\widehat{\text{RMST}}^{-i}(\tau),
$$ {#eq-pseudo-value-rmst}
<!--  -->
where $\tilde{\theta}_i(\tau)$ is the pseudo-value of the restricted mean survival time at time $\tau$ for observation $i$.

Continuing the tumor data example from @sec-pseudo-value-S, now consider how the RMST depends on covariates. 
The general idea is illustrated in @fig-pseudo-rmst, which displays survival curves for each group (complications vs. no complications) with the RMST shown as the area under the curve up to $\tau = 1000$ days.
Thus, within the first 1000 days after operation, patients with complications are expected to live 246 days less than patients without complications (the difference between the areas under the two curves).

![Survival curves with RMST visualization at $\tau = 1000$ days, stratified by complications status. The shaded area under each curve represents the RMST, with the numerical value displayed as text.](Figures/reductions/pseudo-rmst-complications-lm.png){#fig-pseudo-rmst fig-alt="Two-panel faceted plot showing survival curves for patients with and without complications. Each panel displays a survival curve with the area under the curve up to 1000 days shaded in a transparent color, representing the Restricted Mean Survival Time (RMST). The RMST on the left plot (no complications) is 843.1 days, the RMST on the right plot (complications) is 597.1 days."}

To compare the RMST estimates to the pseudo-value approach, fit the linear model 
<!--  -->
$$
\hat{\tilde{\theta}}(\tau) = \widehat{\text{RMST}}(\tau|\xx_i) = \hat{\beta}_{\tau,0} + \hat{\beta}_{\tau,1} x_{i,1},\quad x_{i,1} = \mathbb{I}(\text{complications}_i = \text{`yes'}),
$$
<!--  -->

and again assume $h(x) = x$ though note in practice one may need to use a different function such as $h(x) = \exp(x)$ to map $\Reals$ to $\NNReals$ as the RMST cannot be negative.

For time point $\tau = 1000$ days, the estimated coefficient is $\hat{\beta}_1 \approx -239$. 
Thus, the expected RMST for patients with complications is reduced by around 239 days, which is similar to the result obtained from the Kaplan-Meier analysis in @fig-pseudo-rmst. 
Once again, this model can be extended to include age such that

$$
\widehat{RMST}(\tau|\xx_i) = \hat{\beta}_{\tau,0} + \hat{\beta}_{\tau,1} x_{i,1} + \hat{\beta}_{\tau,2} x_{i,2},\quad x_{i,1} = \mathbb{I}(\text{complications}_i = \text{`yes'}), x_{i,2} = \text{age}_i,
$$

where $x_{i,1}$ as before and $x_{i,2}$ is the age of subject $i$. The respective estimates are $\hat{\beta}_1 \approx -230$ and $\hat{\beta}_2 \approx -3$, such that, given everything else being equal, the expected RMST is reduced by circa 3 days per year of age. The effect of complications, $\hat{\beta}_1$, is slightly reduced when age is included and can be interpreted as the effect of complications on RMST adjusted for age. 

## Pseudo-values in event-history analysis {#sec-pseudo-value-eha}

The pseudo-value approach can be extended to more complex event-history settings, including competing risks and multi-state models (@Andersen2010; @parnerRegressionModelsCensored2023; @andersen2003generalisedlinear). The key idea remains the same: use univariate, non-parametric estimators of the quantity of interest to calculate pseudo-values, which can then be used as target variables in regression models.

### Pseudo-values for competing risks {#sec-pseudo-value-cr}

In the competing risks setting (@sec-competing-risks), a quantity of particular interest is the cumulative incidence function (CIF) $F_e(\tau)$, which represents the probability of experiencing event $e$ before time $\tau$. 
An unbiased estimator for the CIF is the Aalen-Johansen estimator (@sec-aalen-johanson). 
Pseudo-values for the CIF are thus given by
<!--  -->
$$
\theta_{i,e}(\tau) = nF_{AJ,e}(\tau) - (n-1)F_{AJ,e}^{-i}(\tau),
$${#eq-pseudo-value-cif}
<!--  -->
where $F_{AJ,e}^{-i}(\tau)$ is the Aalen-Johansen estimator of the CIF for event type $e$ obtained by omitting the $i$-th observation from the data set.

Once calculated, these pseudo-values can be used as target variables in regression models to estimate the conditional CIF $F_e(\tau | \xx_i)$ via (@eq-pseudo-value-expectation-2).
Using the identity function for the response, one can directly interpret the covariate effects on the cumulative incidence of a specific event type.

### Pseudo-values for multi-state models {#sec-pseudo-value-trans-prob}
<!-- TODO: when eha section is updated to contain definitions of state occupation probabilities, update this section accordingly -->
In multi-state settings (@sec-multi-state), pseudo-values are often used in order to estimate state occupation probabilities conditional on features. These represent the probability of being in state $e$ at time $\tau$. Non-parametric estimators for state occupation probabilities can be obtained via the Aalen-Johansen estimator for multi-state models (@sec-ms-aalen-johanson). The pseudo-values for state occupation probabilities are then defined as

$$
\tilde{\theta}_{i,e}(\tau) = nP_{AJ,e}(\tau) - (n-1)P_{AJ,e}^{-i}(\tau),
$${#eq-pseudo-value-trans-prob}

where $P_{AJ,e}(\tau)$ is the Aalen-Johansen estimator of the state occupation probability for event type $e$ at time $\tau$, and $P_{AJ,e}^{-i}(\tau)$ is the same estimator obtained by omitting the $i$-th observation.

These pseudo-values can be used to model conditional state occupation probabilities $P_e(\tau | \xx_i)$ using standard regression techniques. This approach is particularly flexible as it allows for modeling state occupation probabilities directly, without the need to specify and estimate all transition hazards [@andersen2003generalisedlinear].


## Conclusion

:::: {.callout-warning icon=false}

## Key takeaways

* The pseudo-value based approach allows estimation of arbitrary quantities of interest at set time points, conditional on covariates, as long as an univariate, unbiased estimator of the quantity of interest is available.
* It avoids strong assumptions like the proportional hazards assumption or the accelerated failure time assumption, which can be violated in practice and allows modelling even in complex event-history settings.
* As a regression to reduction technique, this method allows many powerful regression models to be used 'out-of-the-box' from standard software implementations without any additional modifications.
* When the identity function is used as the response, feature effects can be interpreted directly as effects on the quantity of interest, rather than being expressed in terms of hazard ratios or other relative measures.
* Standard survival metrics can be used to evaluate pseudo-value predictions.
::::

:::: {.callout-important icon=false}

## Limitations
* Pseudo-values can take any values in $\Reals$, which may not correspond realistically to the target of interest (for example, survival probabilities). This can be mitigated with response functions. However, even without transformation, as seen in the examples above, pseudo-value predictions often fall within the desired range as long as $\tau$ is not at the edge of the follow-up period (where the survival probability is close to 0 or 1) and as long as $\xx$ is not an outlier in the feature space.
* Pseudo-values are technically not independent (all observations are used to calculate $\hat{\psi}(\tau)$ and most to calculate $\hat{\psi}^{-i}(\tau)$); this usually has little impact on point estimation of $f(\xx)$ too much, but may affect variance estimation and inference. 
* Calculating pseudo-values can be computationally expensive requiring $m(n+1)$ calculations of the estimator for $m$ time points and $n$ observations. However, for specific use cases, efficient implementations based on infinitesimal jack-knife and other methods have been suggested in the literature and implemented in standard software packages. 
* Interpretation of feature effects is hindered to some extent by being time dependent; this can however also be viewed as an advantage, as the approach does not make strict assumptions like proportional hazards or accelerated failure time assumptions, which can be violated in practice.

::::

:::: {.callout-tip icon=false}

## Further reading

* @Andersen2010 provides a comprehensive overview of pseudo-value methods in survival analysis.
* @parnerRegressionModelsCensored2023 and @bouaziz2023fastapproximations specifically discuss pseudo-value calculations in the context of different censoring types.

::::






