{{< include _setup.qmd >}}

#  Getting Started {.unnumbered .unlisted}

::: {.content-visible when-format="html"}

## by Raphael Sonabend and Andreas Bender {.unnumbered .unlisted}

This book is a work in progress, the final work will be published by Chapman and Hall/Crc.
This electronic version (including pdf download) will always be free and open access ([CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)).

We will continue to update this version after publication to correct mistakes (big and small), as well as making minor and major additions, if you notice any mistakes please feel free to [open an issue](https://github.com/RaphaelS1/MLSA/issues).

## Licensing

<!-- same text as mlr3book -->
Code chunks in this book are licensed under [MIT](https://opensource.org/license/mit/) and all figures generated by code chunks are licensed under [CC BY](https://creativecommons.org/licenses/by/4.0/), which means you can copy, adapt, and redistribute this material in any way that you like as long as you reference this book (see citation information just below).

All other content (text, tables, figures not generated from code chunks, etc.) is licensed under [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/), which means you can copy and redistribute the material however you want and adapt it however you want, as long as: you **do** reference the book (see citation information below), you do **not** use any material for commercial purposes, you **do** use a [CC BY-NC-SA 4.0 compatible license](https://creativecommons.org/share-your-work/licensing-considerations/compatible-licenses) if you adapt the material.

If you have any questions about licensing just [open an issue](https://github.com/RaphaelS1/MLSA/issues) and we will help you out.

## Citation Information

Whilst this book remains a work in progress you can cite as

```
Sonabend. R, Bender. A. (2023). Machine Learning in Survival Analysis.
https://www.mlsabook.com.

@book{MLSA2023
    title = Machine Learning in Survival Analysis
    editor = {Raphael Sonabend, Andreas Bender},
    url = {https://www.mlsabook.com},
    year = {2023}
}
```

## Contributing to this book

We welcome contributions to the electronic copy of the book, whether they're issues picking up on typos, requests for additional content, or pull requests with contributions from any size.
All contributions will be acknowledged in the preface of the book.

Before you contribute please make sure you have read our [code of conduct](https://github.com/RaphaelS1/MLSA/blob/main/.github/CODE_OF_CONDUCT.md).

## Biographies {.unnumbered}

Raphael Sonabend is a Visiting Researcher at Imperial College London and an Open Source Manager at Genomics England. They hold a PhD in statistics, specializing in machine learning applications for survival analysis. They created the R packages `mlr3proba`, `survivalmodels`, and the Julia package `SurvivalAnalysis.jl`.

Andreas Bender is...

# Preface

> "Everything happens to everybody sooner or later if there is time enough" - George Bernard Shaw

> "...but in this world nothing can be said to be certain, except death and taxes." - Benjamin Franklin

Together, the epigraphs for this book perfectly and succinctly set up the 'survival problem'.
In maths perhaps we could be even more succinct: $\forall X (P(X) \rightarrow 1\text{ as t }\rightarrow \infty)$.
Of course, nothing is immortal and therefore there is never 'time enough'.
Thus creating the predictive 'survival problem': given an individual (object), predict when this individual will experience an event of interest.
The 'problem' in survival analysis is that we implicitly assume the individual *will* experience the event, which is of course not guaranteed (with the exception of death or taxes).
To make matters worse, the vast majority of accessible models to make survival predictions, encode an even stricter assumption, that either the event of interest will occur, or, for some completely unrelated reason, it will not.
For example, a model assumes either a marathon runner will finish a race, or they won't due to some arbitrary reason, e.g., someone else pushing them over.
This assumption does not reflect the real-world, in practice the runner may not finish the marathon due to some related reasons, such as extreme exhaustion.

A note from RS: When I began writing my PhD thesis I was motivated by two questions: given the enormous power of survival analysis (who doesn't want to be able to predict the future?), and given the rapid rise in interest in machine learning, i) why are more data scientists not using machine learning? ii) and why do machine learning models fail to outperform simple, classical models that have been around for decades?
The answer it transpired was fairly simple, and largely ignored by researchers (including myself), for decades.
The survival analysis problem is simply impossible.
In 1975, Anastasios Tsiatis published a paper as part of their PhD submission [@Tsiatis1975] demonstrating the 'non-identifiability problem' in survival analysis.
In the abstract of this paper, Tsiatis sums up the problem we face today: "based on the assumption that [competing events] are independent, may have no resemblance to reality".
In simpler terms, the majority of survival models encode an assumption that is very hard (/impossible) to justify in reality and in doing so, predictions made by these models "may have no resemblance to reality".
Despite this, the majority of this book is going to focus on these models, and we will come back to why after a brief detour to the alternative treatment of events.

A note from AB (competing risks): Amet occaecat veniam consectetur irure labore sit nulla ex quis non id non. Tempor fugiat dolore eiusmod veniam dolore labore eu adipisicing aliqua quis culpa proident in aliqua. Mollit incididunt sunt mollit id fugiat est eu esse cillum enim. Occaecat culpa sint reprehenderit proident quis duis reprehenderit Lorem sint deserunt cupidatat nisi. Aliquip duis ullamco aliquip ullamco nisi non fugiat eu sunt cupidatat qui eu velit elit. Dolore occaecat id ad reprehenderit ea irure qui mollit nostrud.

So in this book, we will consider both the 'standard framework' and the competing risks framework.
Instead of treating these as two distinct parts to the book, we will interweave methods throughout the narrative, to highlight our belief that all practitioners should have an equally firm grasp on both settings.
Where competing risk alternatives do not yet exist, readers are directed to @sec-car which includes a section on extending *any* survival model, to the competing risks setting.
Some readers may be questioning why we event both including the non-competing framework at all, which is a reasonable question.
The answer is threefold, firstly there are times when this setting is appropriate, if you can reasonably justify that the sole reason for an event not occurring is independent of the event itself (we will see examples of this later in the book), then this framework is valid and is the simpler setting; secondly, as mentioned above, any model in this framework can be extended to competing risks, and therefore knowing about these models is still important; thirdly, so that readers who may be reviewing other academic texts, can spot errors and help correct them when found in the wild.

## Overview to the book

We wrote this book as we felt there was a gap in introductory academic textbooks for machine learning that satisfactorily cover the survival setting.
There are many good books for machine learning (e.g., @Hastie2013, @Hastie2001, @Bishop2006) and survival analysis (e.g., @Collett2014, @KalbfleischPrentice1973) but we hope this book bridges a gap between these two fields.
We recommend reading this book alongside (or after) @Hastie2013 and @Collett2014 as we do not want to duplicate content from these books.
Instead, we will introduce machine learning methods in the regression setting and then demonstrate how these can extend to survival analysis.
In @sec-intro we explain the motivation of this choice by demonstrating how survival analysis can be reduced to the regression and classification settings and we exploit these results further in @sec-car.

This book may be useful for Masters or PhD students who are specialising in machine learning in survival analysis, or machine learning practitioners looking to work in the survival setting, or statisticians who are familiar with survival analysis but less so with machine learning.
We include examples and exercises in R, Julia, and Python [FIXME].

This book is split into three parts:

**Part I: Survival Analysis and Machine Learning**<br>
We begin the book by introducing the basics of survival analysis and machine learning and unifying terminology between the two to enable us to meaningfully talk about 'machine learning in survival analysis' (MLSA).
Sit cupidatat non enim quis amet anim velit incididunt.

**Part II: MLSA Models**<br>
In the second part of the book we begin our deep dive into machine learning models for solving survival analysis problems.
We begin with 'classical' models that may not be considered 'machine learning' and then continue by exploring different classes of machine learning models including random forests, gradient boosting machines, and neural networks.
Veniam laboris consequat commodo nostrud in ipsum occaecat consequat ea adipisicing fugiat Lorem nisi in.

**Part III: Evaluating and Extending**<br>
In the next part of the book we discuss how to evaluate the models covered in the previous part using measures of discrimination, calibration, and scoring rules.
We then discuss how to further extend models and pipelines by making use of composition and reduction and the close links between survival analysis, regression, and classification.
Ea ex adipisicing occaecat eu consectetur sunt culpa ad.

In the final chapters of the book we list recommended open-source software for survival analysis and then conclude the book.

:::

\frontmatter

::: {.content-visible when-format="pdf"}

\halftitle{Main Title}{Standard blurb goes here}%%Placeholder for Half title

\seriespg{Series page goes here (if applicable); otherwise blank}

\title{Machine Learning in Survival Analysis}

\edition{First Edition}

\author{Raphael Sonabend, Andreas Bender}

\locpage

\cleardoublepage
\setcounter{page}{7}

\tableofcontents

\chapter*{Preface}

> "Everything happens to everybody sooner or later if there is time enough" - George Bernard Shaw

> "...but in this world nothing can be said to be certain, except death and taxes." - Benjamin Franklin

Together, the epigraphs for this book perfectly and succinctly set up the 'survival problem'.
In maths perhaps we could be even more succinct: $\forall X (P(X) \rightarrow 1\text{ as t }\rightarrow \infty)$.
Of course, nothing is immortal and therefore there is never 'time enough'.
Thus creating the predictive 'survival problem': given an individual (object), predict when this individual will experience an event of interest.
The 'problem' in survival analysis is that we implicitly assume the individual *will* experience the event, which is of course not guaranteed (with the exception of death or taxes).
To make matters worse, the vast majority of accessible models to make survival predictions, encode an even stricter assumption, that either the event of interest will occur, or, for some completely unrelated reason, it will not.
For example, a model assumes either a marathon runner will finish a race, or they won't due to some arbitrary reason, e.g., someone else pushing them over.
This assumption does not reflect the real-world, in practice the runner may not finish the marathon due to some related reasons, such as extreme exhaustion.

A note from RS: When I began writing my PhD thesis I was motivated by two questions: given the enormous power of survival analysis (who doesn't want to be able to predict the future?), and given the rapid rise in interest in machine learning, i) why are more data scientists not using machine learning? ii) and why do machine learning models fail to outperform simple, classical models that have been around for decades?
The answer it transpired was fairly simple, and largely ignored by researchers (including myself), for decades.
The survival analysis problem is simply impossible.
In 1975, Anastasios Tsiatis published a paper as part of their PhD submission [@Tsiatis1975] demonstrating the 'non-identifiability problem' in survival analysis.
In the abstract of this paper, Tsiatis sums up the problem we face today: "based on the assumption that [competing events] are independent, may have no resemblance to reality".
In simpler terms, the majority of survival models encode an assumption that is very hard (/impossible) to justify in reality and in doing so, predictions made by these models "may have no resemblance to reality".
Despite this, the majority of this book is going to focus on these models, and we will come back to why after a brief detour to the alternative treatment of events.

A note from AB (competing risks): Amet occaecat veniam consectetur irure labore sit nulla ex quis non id non. Tempor fugiat dolore eiusmod veniam dolore labore eu adipisicing aliqua quis culpa proident in aliqua. Mollit incididunt sunt mollit id fugiat est eu esse cillum enim. Occaecat culpa sint reprehenderit proident quis duis reprehenderit Lorem sint deserunt cupidatat nisi. Aliquip duis ullamco aliquip ullamco nisi non fugiat eu sunt cupidatat qui eu velit elit. Dolore occaecat id ad reprehenderit ea irure qui mollit nostrud.

So in this book, we will consider both the 'standard framework' and the competing risks framework.
Instead of treating these as two distinct parts to the book, we will interweave methods throughout the narrative, to highlight our belief that all practitioners should have an equally firm grasp on both settings.
Where competing risk alternatives do not yet exist, readers are directed to @sec-car which includes a section on extending *any* survival model, to the competing risks setting.
Some readers may be questioning why we event both including the non-competing framework at all, which is a reasonable question.
The answer is threefold, firstly there are times when this setting is appropriate, if you can reasonably justify that the sole reason for an event not occurring is independent of the event itself (we will see examples of this later in the book), then this framework is valid and is the simpler setting; secondly, as mentioned above, any model in this framework can be extended to competing risks, and therefore knowing about these models is still important; thirdly, so that readers who may be reviewing other academic texts, can spot errors and help correct them when found in the wild.

\subsection*{Overview}

We wrote this book as we felt there was a gap in introductory academic textbooks for machine learning that satisfactorily cover the survival setting.
There are many good books for machine learning (e.g., @Hastie2013, @Hastie2001, @Bishop2006) and survival analysis (e.g., @Collett2014, @KalbfleischPrentice1973) but we hope this book bridges a gap between these two fields.
We recommend reading this book alongside (or after) @Hastie2013 and @Collett2014 as we do not want to duplicate content from these books.
Instead, we will introduce machine learning methods in the regression setting and then demonstrate how these can extend to survival analysis.
In @sec-intro we explain the motivation of this choice by demonstrating how survival analysis can be reduced to the regression and classification settings and we exploit these results further in @sec-car.

This book may be useful for Masters or PhD students who are specialising in machine learning in survival analysis, or machine learning practitioners looking to work in the survival setting, or statisticians who are familiar with survival analysis but less so with machine learning.
We include examples and exercises in R, Julia, and Python [FIXME].

This book is split into three parts:

**Part I: Survival Analysis and Machine Learning**<br>
We begin the book by introducing the basics of survival analysis and machine learning and unifying terminology between the two to enable us to meaningfully talk about 'machine learning in survival analysis' (MLSA).
Sit cupidatat non enim quis amet anim velit incididunt.

**Part II: MLSA Models**<br>
In the second part of the book we begin our deep dive into machine learning models for solving survival analysis problems.
We begin with 'classical' models that may not be considered 'machine learning' and then continue by exploring different classes of machine learning models including random forests, gradient boosting machines, and neural networks.
Veniam laboris consequat commodo nostrud in ipsum occaecat consequat ea adipisicing fugiat Lorem nisi in.

**Part III: Evaluating and Extending**<br>
In the next part of the book we discuss how to evaluate the models covered in the previous part using measures of discrimination, calibration, and scoring rules.
We then discuss how to further extend models and pipelines by making use of composition and reduction and the close links between survival analysis, regression, and classification.
Ea ex adipisicing occaecat eu consectetur sunt culpa ad.

In the final chapters of the book we list recommended open-source software for survival analysis and then conclude the book.

\subsection*{Citing this book}

Whilst this book remains a work in progress you can cite it as

```
Sonabend. R, Bender. A. (2023). Machine Learning in Survival Analysis.
https://www.mlsabook.com.

@book{MLSA2023
    title = Machine Learning in Survival Analysis
    editor = {Raphael Sonabend, Andreas Bender},
    url = {https://www.mlsabook.com},
    year = {2023}
}
```

Please see the front page of the book website ([https://www.mlsabook.com](https://www.mlsabook.com)) for full licensing details.

\vspace{10mm}

We hope you enjoy reading this book.

\vspace{5mm}

Raphael and Andreas

\chapter*{Authors}

Raphael Sonabend is a Visiting Researcher at Imperial College London and an Open Source Manager at Genomics England. They hold a PhD in statistics, specializing in machine learning applications for survival analysis. They wrote the `mlr3` packages `mlr3proba` and `mlr3benchmark`.

Andreas Bender is...

:::

\mainmatter
